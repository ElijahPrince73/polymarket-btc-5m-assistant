<div class="trades">
    <h2>Trades</h2>
    <button id="start-trading">Start Trading</button>
    <button id="stop-trading">Stop Trading</button>
    <table id="recent-trades-table">
        <thead>
            <tr>
                <th>Time</th>
                <th>Outcome</th>
                <th>Gain/Loss</th>
            </tr>
        </thead>
        <tbody id="recent-trades-body">
            <tr><td colspan="3">Loading recent trades...</td></tr>
        </tbody>
    </table>
</div>
<script>
    async function updateTrades() {
        const response = await fetch('/api/trades');
        const trades = await response.json();
        const tradesBody = document.getElementById('recent-trades-body');

        tradesBody.innerHTML = trades.length > 0 ? trades.map(trade => `<tr>
                <td>${new Date(trade.time).toLocaleString()}</td>
                <td>${trade.outcome}</td>
                <td>${trade.pnl > 0 ? 'Gain' : 'Loss'}</td>
            </tr>`).join('') : '<tr><td colspan="3">No trades found.</td></tr>';
    }

    document.getElementById('start-trading').addEventListener('click', async () => {
        const response = await fetch('/api/live/start-trading', { method: 'POST' });
        if (response.ok) {
            console.log('Trading started!');
            updateTrades(); // Refresh trades on starting
        } else {
            console.error('Failed to start trading.');
        }
    });

    document.getElementById('stop-trading').addEventListener('click', async () => {
        const response = await fetch('/api/live/stop-trading', { method: 'POST' });
        if (response.ok) {
            console.log('Trading stopped!');
            updateTrades(); // Refresh trades on stopping
        } else {
            console.error('Failed to stop trading.');
        }
    });

    // Call updateTrades on load to show current trades
    document.addEventListener('DOMContentLoaded', updateTrades);
</script>